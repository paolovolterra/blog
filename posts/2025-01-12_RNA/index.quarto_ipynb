{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "d4aaa61d",
   "metadata": {},
   "source": [
    "---\n",
    "title: \"Registro Nazionale degli Aiuti di Stato\"\n",
    "subtitle: \"_trasparenza e controllo sugli aiuti pubblici concessi in conformità alla normativa europea sugli aiuti di Stato_ \"\n",
    "draft: false\n",
    "\n",
    "date: 2025-01-12\n",
    "date-format: long #\"MMMM DD, YYYY\" # \"`r format(Sys.Date(), '%B %d, %Y')`\"\n",
    "#date-format: \"MMM D, YYYY\"\n",
    "created: 2025-01-12\n",
    "updated: today\n",
    "lang: it\n",
    "tags: [agevolazioni, Invitalia, Python, RNA, Opendata]\n",
    "author: \"Paolo Volterra\"\n",
    "\n",
    "format:\n",
    "  html:\n",
    "    toc: true             # Abilita il sommario\n",
    "    toc-depth: 3          # Mostra fino al terzo livello di intestazioni\n",
    "    number-sections: true # Aggiunge numeri alle sezioni e sottosezioni\n",
    "    toc-location: right   # Posiziona il sommario a sinistra (o usa `right` per destra)\n",
    "    toc-title: \"Indice\"   # (Facoltativo) Titolo del sommario\n",
    "\n",
    "categories:\n",
    "  - Agevolazioni\n",
    "  - Invitalia\n",
    "  - Python\n",
    "  - RNA\n",
    "  - Opendata\n",
    "  \n",
    "jupyter: \"python3\"\n",
    "execute:\n",
    "  freeze: false # con true blocco l'esecuzione degli script quando aggiorno solo il testo\n",
    "\n",
    "# 1. quarto preview d:/paolovolterra.github.io/posts/2508_RNA/RNA.qmd\n",
    "# 2. quarto render d:/paolovolterra.github.io/posts/2508_RNA/RNA.qmd\n",
    "# 3. git add d:/paolovolterra.github.io/docs/posts/2508_RNA/RNA.html\n",
    "# 4. git status\n",
    "# 5. git add . (se hai rilevato altre modifiche e le voi introitare)\n",
    "# 6. git commit -m \"Aggiornata la pagina: RNA\"\n",
    "# 7. git pull origin main --rebase\n",
    "# 8. git push origin main\n",
    "# 9. git log\n",
    "---\n",
    "\n",
    "# Obiettivi dello studio\n",
    "- manipolazione dei parquet file\n",
    "- applicazione di SQL in Python\n",
    "\n",
    "---\n",
    "\n",
    "Il [**Registro Nazionale degli Aiuti di Stato**](https://www.rna.gov.it/) #RNA è uno strumento gestito dal Ministero delle Imprese e del Made in Italy (ex Ministero dello Sviluppo Economico - MiSE), che permette di raccogliere, monitorare e pubblicare informazioni relative agli aiuti di Stato concessi alle imprese e agli enti in Italia. \n",
    "\n",
    "![](./media/01.png)\n",
    "\n",
    "# Obiettivi principali:\n",
    "1. **Trasparenza**: Pubblicare i dettagli degli aiuti concessi, garantendo che le informazioni siano accessibili a cittadini e imprese.\n",
    "2. **Monitoraggio**: Assicurare che i limiti sugli aiuti stabiliti dalla normativa europea siano rispettati.\n",
    "3. **Controllo**: Evitare il superamento delle soglie del regime \"de minimis\" e la concessione di aiuti incompatibili con le regole dell’Unione Europea.\n",
    "\n",
    "# La realizzazione\n",
    "\n",
    "Il #RNA è stato realizzato come parte di un'importante azione di sistema cofinanziata dall'Unione Europea. In particolare, il progetto ha beneficiato di risorse pari a **17.715.920,01 euro**, assegnate nell'ambito del **Programma Operativo Complementare al PON Governance e Capacità Istituzionale 2014-2020**. \n",
    "\n",
    "La progettazione e la realizzazione di una prima versione prototipale del Registro sono state completate nel 2016, con un investimento di **2.652.236,00 euro**. \n",
    "\n",
    "Il #RNA è operativo dal 12 agosto 2017 e rappresenta uno strumento fondamentale per garantire la trasparenza e il controllo degli aiuti di Stato concessi in Italia. \n",
    "\n",
    "\n",
    "# Informazioni contenute nel Registro:\n",
    "Il #RNA include informazioni come:\n",
    "- Identità del beneficiario (nome, partita IVA, codice fiscale).\n",
    "- Tipo di aiuto concesso (contributo a fondo perduto, credito d’imposta, agevolazione fiscale, ecc.).\n",
    "- Importo e intensità dell’aiuto.\n",
    "- Riferimenti alla normativa e al regime di aiuti in base al quale è stato concesso.\n",
    "- Ente erogatore.\n",
    "\n",
    "\n",
    "# Normativa di riferimento:\n",
    "Il #RNA è disciplinato dal **Decreto Legge n. 123/2017**, che stabilisce obblighi per le amministrazioni pubbliche e i soggetti che gestiscono misure di aiuto. L'obiettivo è garantire che tutti gli aiuti siano comunicati e registrati.\n",
    "\n",
    "# Accesso al Registro:\n",
    "Il #RNA è consultabile tramite una piattaforma online, accessibile sia dagli enti pubblici che dagli operatori economici. \n",
    "\n",
    "Alcune informazioni, per motivi di riservatezza, potrebbero essere soggette a limitazioni.\n",
    "\n",
    "\n",
    "# Controlli sul \"de minimis\":\n",
    "Il #RNA permette di verificare se un’impresa ha superato la soglia prevista dal regime \"de minimis\" (200.000 euro nell’arco di tre esercizi finanziari, salvo eccezioni per alcuni settori).\n",
    "\n",
    "---\n",
    "\n",
    "Oltre all'interrogazione online, #RNA permette il [download degli #opendata](https://www.rna.gov.it/open-data/aiuti)\n",
    "\n",
    "![](./media/04.png)\n",
    "\n",
    "\n",
    "# Gli opendata RNA in xml\n",
    "\n",
    "#RNA aggiorna costantemente il proprio DB conn le segnalazioni dovute dai mittenti normativamente previsti.\n",
    "\n",
    "Le date degli [opendata XML messi a disposizione](https://www.rna.gov.it/open-data/aiuti) corrispondono al mese della variabile \"DATA_CONCESSIONE\" contenuta in ognuno di loro\n",
    "\n",
    "RNA riceve però anche informazioni datate e quindi aggiorna tutto.\n",
    "\n",
    "Potenzialmente, quindi, **tutti** gli XML andrebbero riscaricati ...\n",
    "\n",
    "Di seguito, ad esempio, gli ultimi 3 file parquet del 2024 da me realizzati, la data di mia aggiornamento e i df.shape\n",
    "\n",
    "## OpenData_Aiuti_2024_12.parquet\n",
    "- 20250111 (107273, 21)\n",
    "- 20250105 (105454, 21)\n",
    "- 20250101 (100270, 21)\n",
    "- 20241221 (91504, 21)\n",
    "- 20241214 (36363, 21)\n",
    "- 20241207 (16243, 21)\n",
    "\n",
    "## OpenData_Aiuti_2024_11.parquet\n",
    "- 20250111 (141510, 21)\n",
    "- 20250107 (141523, 21)\n",
    "- 20241201 (136061, 21)\n",
    "- 20241130 (115693, 21)\n",
    "- 20241124 (115693, 21)\n",
    "- 20241117 (19701, 21)\n",
    "- 20241110 (19701, 21)\n",
    "\n",
    "## OpenData_Aiuti_2024_10.parquet\n",
    "- 20250107 (238465, 21)\n",
    "- 20241110 (238076, 21)\n",
    "- 20241101 (122656, 21)\n",
    "- 20241029 (122656, 21)\n",
    "- 20241026 (59146, 21)\n",
    "- 20241019 (59146, 21)\n",
    "\n",
    "Non ho ancora verificato se la data è quella di concessione o quella di registrazione in RNA\n",
    "\n",
    "\n",
    "# Analisi sull'xml più recente\n",
    "\n",
    "Appresso riporto alcune sintesi dell'ultimo XML -> parquet da me prodotto\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "45b77892",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| echo: false\n",
    "import pyarrow.parquet as pq # pip install pyarrow\n",
    "import pandas as pd\n",
    "import glob\n",
    "import duckdb\n",
    "pd.set_option('display.max_rows', None)\n",
    "import os\n",
    "os.chdir('D:/duckdb/files/RNA2/')\n",
    "# import cudf\n",
    "pd.set_option('display.max_colwidth', 500)\n",
    "\n",
    "con = duckdb.connect()\n",
    "con.execute(\"PRAGMA threads=8\") # enable automatic query parallelization\n",
    "con.execute(\"PRAGMA enable_object_cache\") # enable caching of parquet metadata\n",
    "\n",
    "#pd.set_option('display.max_rows', None)\n",
    "\n",
    "pd.options.display.float_format = '{:,}'.format\n",
    "\n",
    "# pd.options.display.float_format = '{:.2f}'.format"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4015e5c8",
   "metadata": {},
   "source": [
    "## Quanti aiuti contiene"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "16744768",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count(DISTINCT CF)</th>\n",
       "      <th>count(CF)</th>\n",
       "      <th>count(DISTINCT CAR)</th>\n",
       "      <th>count(DISTINCT CONCEDENTE)</th>\n",
       "      <th>sum(CAST(NOMINALE AS INTEGER))</th>\n",
       "      <th>sum(CAST(AIUTO AS INTEGER))</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>227772</td>\n",
       "      <td>288480</td>\n",
       "      <td>478</td>\n",
       "      <td>375</td>\n",
       "      <td>4,198,060,832.0</td>\n",
       "      <td>2,169,603,080.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   count(DISTINCT CF)  count(CF)  count(DISTINCT CAR)  \\\n",
       "0              227772     288480                  478   \n",
       "\n",
       "   count(DISTINCT CONCEDENTE)  sum(CAST(NOMINALE AS INTEGER))  \\\n",
       "0                         375                 4,198,060,832.0   \n",
       "\n",
       "   sum(CAST(AIUTO AS INTEGER))  \n",
       "0              2,169,603,080.0  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT count(distinct(CF)), count((CF)), count(distinct(CAR)),count(distinct(CONCEDENTE)), sum(cast(NOMINALE as integer)), sum(cast(AIUTO as integer)) FROM 'OpenData_Aiuti_2025_01.parquet'\").df()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "407408a2",
   "metadata": {},
   "source": [
    "## Quali misure hanno più aiuti"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "8de2eb73",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>MISURA</th>\n",
       "      <th>CONCESSIONI</th>\n",
       "      <th>NOMINALE</th>\n",
       "      <th>AIUTI</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ESONERO DAL VERSAMENTO DEI CONTRIBUTI PREVIDENZIALI PER NUOVE ASSUNZIONI/TRASFORMAZIONI A TEMPO INDETERMINATO NEL BIENNIO 2021 - 2022 (ART. 1 COMMI 10 - 15 L. 178/2020)</td>\n",
       "      <td>118427</td>\n",
       "      <td>881,173,792.0</td>\n",
       "      <td>881,173,792.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ESONERO DAL VERSAMENTO DEI CONTRIBUTI PREVIDENZIALI PER L'ASSUNZIONE DI GIOVANI LAVORATORI  ( ART. 1 COMMA 10-15 L. 178/2020 - ART. 1 COMMA 297 L. 197/2022)</td>\n",
       "      <td>75758</td>\n",
       "      <td>393,090,967.0</td>\n",
       "      <td>393,090,967.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ESONERO DAL VERSAMENTO DEI CONTRIBUTI PREVIDENZIALI PER ASSUNZIONI DI DONNE LAVORATRICI  DAL 1 LUGLIO 2022 ( ART. 1 , COMMI 16-19 L.178/2020 -ART. 1 COMMA 298 L.197/2022)</td>\n",
       "      <td>33952</td>\n",
       "      <td>97,152,474.0</td>\n",
       "      <td>97,152,474.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ESONERO DAL VERSAMENTO DEI CONTRIBUTI PREVIDENZIALI PER ASSUNZIONI DI DONNE LAVORATRICI NEL BIENNIO 2021 - 2022  (ART. 1 COMMI 16 - 19 L. 178/2020)</td>\n",
       "      <td>26226</td>\n",
       "      <td>55,388,921.0</td>\n",
       "      <td>55,388,921.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>FONDO DI GARANZIA PER LE PICCOLE E MEDIE IMPRESE</td>\n",
       "      <td>14840</td>\n",
       "      <td>1,933,831,009.0</td>\n",
       "      <td>127,456,523.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>REGOLAMENTO PER I FONDI INTERPROFESSIONALI PER LA FORMAZIONE CONTINUA PER LA CONCESSIONI DI AIUTI DI STATO ESENTATI AI SENSI DEL REGOLAMENTO CE N.651/2014 E IN REGIME DE MINIMIS AI SENSI DEL REGOLAMENTO CE N.1407/2013</td>\n",
       "      <td>6093</td>\n",
       "      <td>30,887,740.0</td>\n",
       "      <td>30,476,607.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>NUOVA SABATINI - FINANZIAMENTI PER L'ACQUISTO DI NUOVI MACCHINARI, IMPIANTI E ATTREZZATURE DA PARTE DELLE PICCOLE E MEDIE IMPRESE - VERSIONE MODIFICATA DA CODICE CE SA.47180</td>\n",
       "      <td>2502</td>\n",
       "      <td>36,229,375.0</td>\n",
       "      <td>36,229,375.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>VOUCHER DIGITALIZZAZIONE 2024</td>\n",
       "      <td>536</td>\n",
       "      <td>8,670,819.0</td>\n",
       "      <td>8,670,819.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>PROGETTI INTEGRATI DI FILIERA 2023-2025</td>\n",
       "      <td>449</td>\n",
       "      <td>14,386,187.0</td>\n",
       "      <td>14,386,187.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>AVVISO PUBBLICO PER L’ASSEGNAZIONE DI VOUCHER AZIENDALI A CATALOGO PER INTERVENTI DI FORMAZIONE CONTINUA – SECONDA EDIZIONE</td>\n",
       "      <td>332</td>\n",
       "      <td>1,051,790.0</td>\n",
       "      <td>1,051,790.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>BANDO FIERE INTERNAZIONALI - ANNO 2024 (24FI)</td>\n",
       "      <td>249</td>\n",
       "      <td>505,600.0</td>\n",
       "      <td>505,600.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>FVG – DGR 1987/2022 - CRITERI E MODALITÀ PER CONCESSIONE DI GARANZIE E CONTRIBUZIONI INTEGRATIVE A FAVORE DELLE IMPRESE COLPITE DALL'AUMENTO DEI PREZZI DEL GAS E DELL'ENERGIA ELETTRICA IN ATTUAZIONE DELL'ART 2, CC 6, 7, 8 E 9, DELLA LR 15/2022</td>\n",
       "      <td>227</td>\n",
       "      <td>225,537.0</td>\n",
       "      <td>123,646.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>[TITOLO II - CAPO 1, 2, 3, 4, 5, 6] REGOLAMENTO REGIONALE DELLA PUGLIA PER GLI AIUTI IN ESENZIONE (REG. REGIONALE N. 17 DEL 30/09/2014-BURP 06/10/2014) - AIUTI A FINALITÀ REGIONALE</td>\n",
       "      <td>224</td>\n",
       "      <td>20,505,184.0</td>\n",
       "      <td>20,505,184.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>AIUTI AI CENTRI DI TRASFERIMENTO TECNOLOGICO</td>\n",
       "      <td>222</td>\n",
       "      <td>6,244,068.0</td>\n",
       "      <td>4,332,494.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>PIÙ ARTIGIANATO</td>\n",
       "      <td>200</td>\n",
       "      <td>5,752,767.0</td>\n",
       "      <td>4,018,773.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>APPROVAZIONE AVVISO BANDO DOTE IMPRESA COLLOCAMENTO MIRATO - FONDO 2022</td>\n",
       "      <td>170</td>\n",
       "      <td>1,327,263.0</td>\n",
       "      <td>1,327,263.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>BANDO “DIGITAL EXPORT 2024-2025”</td>\n",
       "      <td>152</td>\n",
       "      <td>2,167,102.0</td>\n",
       "      <td>2,167,102.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>GARANZIE DEI CONFIDI ALLE PMI</td>\n",
       "      <td>143</td>\n",
       "      <td>11,759,800.0</td>\n",
       "      <td>327,910.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>RER - DGR 412/2024 - ISTITUZIONE DEL REGIME DI AIUTI DI IMPORTANZA MINORE («DE MINIMIS») PER FORMAZIONE RIVOLTA ALLE IMPRESE OPERANTI NEL TERRITORIO DELLA REGIONE EMILIA-ROMAGNA AI SENSI DEL REGOLAMENTO (UE) 2023/2831  APPROVAZIONE DISPOSIZIONI</td>\n",
       "      <td>134</td>\n",
       "      <td>143,824.0</td>\n",
       "      <td>143,824.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>BANDO “FRESCO LAZIO - MISURE A SOSTEGNO DELLE ATTIVITÀ DI RISTORAZIONE, TRASFORMAZIONE E DEL COMMERCIO ALIMENTARE CHE UTILIZZANO E/O SOMMINISTRANO LATTE FRESCO DEL LAZIO”</td>\n",
       "      <td>132</td>\n",
       "      <td>471,542.0</td>\n",
       "      <td>471,542.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                                                                                                                                                                                                  MISURA  \\\n",
       "0                                                                               ESONERO DAL VERSAMENTO DEI CONTRIBUTI PREVIDENZIALI PER NUOVE ASSUNZIONI/TRASFORMAZIONI A TEMPO INDETERMINATO NEL BIENNIO 2021 - 2022 (ART. 1 COMMI 10 - 15 L. 178/2020)   \n",
       "1                                                                                           ESONERO DAL VERSAMENTO DEI CONTRIBUTI PREVIDENZIALI PER L'ASSUNZIONE DI GIOVANI LAVORATORI  ( ART. 1 COMMA 10-15 L. 178/2020 - ART. 1 COMMA 297 L. 197/2022)   \n",
       "2                                                                             ESONERO DAL VERSAMENTO DEI CONTRIBUTI PREVIDENZIALI PER ASSUNZIONI DI DONNE LAVORATRICI  DAL 1 LUGLIO 2022 ( ART. 1 , COMMI 16-19 L.178/2020 -ART. 1 COMMA 298 L.197/2022)   \n",
       "3                                                                                                    ESONERO DAL VERSAMENTO DEI CONTRIBUTI PREVIDENZIALI PER ASSUNZIONI DI DONNE LAVORATRICI NEL BIENNIO 2021 - 2022  (ART. 1 COMMI 16 - 19 L. 178/2020)   \n",
       "4                                                                                                                                                                                                       FONDO DI GARANZIA PER LE PICCOLE E MEDIE IMPRESE   \n",
       "5                              REGOLAMENTO PER I FONDI INTERPROFESSIONALI PER LA FORMAZIONE CONTINUA PER LA CONCESSIONI DI AIUTI DI STATO ESENTATI AI SENSI DEL REGOLAMENTO CE N.651/2014 E IN REGIME DE MINIMIS AI SENSI DEL REGOLAMENTO CE N.1407/2013   \n",
       "6                                                                          NUOVA SABATINI - FINANZIAMENTI PER L'ACQUISTO DI NUOVI MACCHINARI, IMPIANTI E ATTREZZATURE DA PARTE DELLE PICCOLE E MEDIE IMPRESE - VERSIONE MODIFICATA DA CODICE CE SA.47180   \n",
       "7                                                                                                                                                                                                                          VOUCHER DIGITALIZZAZIONE 2024   \n",
       "8                                                                                                                                                                                                                PROGETTI INTEGRATI DI FILIERA 2023-2025   \n",
       "9                                                                                                                            AVVISO PUBBLICO PER L’ASSEGNAZIONE DI VOUCHER AZIENDALI A CATALOGO PER INTERVENTI DI FORMAZIONE CONTINUA – SECONDA EDIZIONE   \n",
       "10                                                                                                                                                                                                         BANDO FIERE INTERNAZIONALI - ANNO 2024 (24FI)   \n",
       "11   FVG – DGR 1987/2022 - CRITERI E MODALITÀ PER CONCESSIONE DI GARANZIE E CONTRIBUZIONI INTEGRATIVE A FAVORE DELLE IMPRESE COLPITE DALL'AUMENTO DEI PREZZI DEL GAS E DELL'ENERGIA ELETTRICA IN ATTUAZIONE DELL'ART 2, CC 6, 7, 8 E 9, DELLA LR 15/2022   \n",
       "12                                                                 [TITOLO II - CAPO 1, 2, 3, 4, 5, 6] REGOLAMENTO REGIONALE DELLA PUGLIA PER GLI AIUTI IN ESENZIONE (REG. REGIONALE N. 17 DEL 30/09/2014-BURP 06/10/2014) - AIUTI A FINALITÀ REGIONALE    \n",
       "13                                                                                                                                                                                                          AIUTI AI CENTRI DI TRASFERIMENTO TECNOLOGICO   \n",
       "14                                                                                                                                                                                                                                       PIÙ ARTIGIANATO   \n",
       "15                                                                                                                                                                               APPROVAZIONE AVVISO BANDO DOTE IMPRESA COLLOCAMENTO MIRATO - FONDO 2022   \n",
       "16                                                                                                                                                                                                                      BANDO “DIGITAL EXPORT 2024-2025”   \n",
       "17                                                                                                                                                                                                                         GARANZIE DEI CONFIDI ALLE PMI   \n",
       "18  RER - DGR 412/2024 - ISTITUZIONE DEL REGIME DI AIUTI DI IMPORTANZA MINORE («DE MINIMIS») PER FORMAZIONE RIVOLTA ALLE IMPRESE OPERANTI NEL TERRITORIO DELLA REGIONE EMILIA-ROMAGNA AI SENSI DEL REGOLAMENTO (UE) 2023/2831  APPROVAZIONE DISPOSIZIONI   \n",
       "19                                                                            BANDO “FRESCO LAZIO - MISURE A SOSTEGNO DELLE ATTIVITÀ DI RISTORAZIONE, TRASFORMAZIONE E DEL COMMERCIO ALIMENTARE CHE UTILIZZANO E/O SOMMINISTRANO LATTE FRESCO DEL LAZIO”   \n",
       "\n",
       "    CONCESSIONI        NOMINALE         AIUTI  \n",
       "0        118427   881,173,792.0 881,173,792.0  \n",
       "1         75758   393,090,967.0 393,090,967.0  \n",
       "2         33952    97,152,474.0  97,152,474.0  \n",
       "3         26226    55,388,921.0  55,388,921.0  \n",
       "4         14840 1,933,831,009.0 127,456,523.0  \n",
       "5          6093    30,887,740.0  30,476,607.0  \n",
       "6          2502    36,229,375.0  36,229,375.0  \n",
       "7           536     8,670,819.0   8,670,819.0  \n",
       "8           449    14,386,187.0  14,386,187.0  \n",
       "9           332     1,051,790.0   1,051,790.0  \n",
       "10          249       505,600.0     505,600.0  \n",
       "11          227       225,537.0     123,646.0  \n",
       "12          224    20,505,184.0  20,505,184.0  \n",
       "13          222     6,244,068.0   4,332,494.0  \n",
       "14          200     5,752,767.0   4,018,773.0  \n",
       "15          170     1,327,263.0   1,327,263.0  \n",
       "16          152     2,167,102.0   2,167,102.0  \n",
       "17          143    11,759,800.0     327,910.0  \n",
       "18          134       143,824.0     143,824.0  \n",
       "19          132       471,542.0     471,542.0  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT upper(misura) MISURA, count(CAR) CONCESSIONI, sum(cast(NOMINALE as integer)) NOMINALE, sum(cast(AIUTO as integer)) AIUTI FROM 'OpenData_Aiuti_2025_01.parquet' group by 1 order by 2 desc limit 20\").df()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "471e334d",
   "metadata": {},
   "source": [
    "## Quali concedenti hanno più aiuti\n",
    "\n",
    "purtroppo il nome del concedente è scritto in modi diversi"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "0fb36217",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CONCEDENTE</th>\n",
       "      <th>CONCESSIONI</th>\n",
       "      <th>NOMINALE</th>\n",
       "      <th>AIUTI</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>INPS</td>\n",
       "      <td>254432</td>\n",
       "      <td>1,427,160,166.0</td>\n",
       "      <td>1,427,160,166.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>BANCA DEL MEZZOGIORNO MEDIOCREDITO CENTRALE S.P.A.</td>\n",
       "      <td>14914</td>\n",
       "      <td>1,934,188,400.0</td>\n",
       "      <td>127,813,914.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>MINISTERO DELLE IMPRESE E DEL MADE IN ITALY - DIPARTIMENTO PER LE POLITICHE PER LE IMPRESE - DIREZIONE GENERALE PER GLI INCENTIVI ALLE IMPRESE</td>\n",
       "      <td>2796</td>\n",
       "      <td>125,965,619.0</td>\n",
       "      <td>89,876,791.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>FONARCOM</td>\n",
       "      <td>1529</td>\n",
       "      <td>2,752,960.0</td>\n",
       "      <td>2,752,960.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>FONDER</td>\n",
       "      <td>1117</td>\n",
       "      <td>1,710,921.0</td>\n",
       "      <td>1,618,699.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>FONDO FOR.TE</td>\n",
       "      <td>768</td>\n",
       "      <td>4,851,253.0</td>\n",
       "      <td>4,851,253.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>FONDOPROFESSIONI</td>\n",
       "      <td>606</td>\n",
       "      <td>579,084.0</td>\n",
       "      <td>575,934.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>UNIONE REGIONALE DELLE CAMERE DI COMMERCIO INDUSTRIA ARTIGIANATO AGRICOLTURA DEL PIEMONTE</td>\n",
       "      <td>560</td>\n",
       "      <td>8,765,133.0</td>\n",
       "      <td>8,765,133.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>FONDIMPRESA</td>\n",
       "      <td>552</td>\n",
       "      <td>7,712,030.0</td>\n",
       "      <td>7,712,030.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>FONCOOP</td>\n",
       "      <td>531</td>\n",
       "      <td>5,685,118.0</td>\n",
       "      <td>5,685,118.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                                                                                       CONCEDENTE  \\\n",
       "0                                                                                                                                            INPS   \n",
       "1                                                                                              BANCA DEL MEZZOGIORNO MEDIOCREDITO CENTRALE S.P.A.   \n",
       "2  MINISTERO DELLE IMPRESE E DEL MADE IN ITALY - DIPARTIMENTO PER LE POLITICHE PER LE IMPRESE - DIREZIONE GENERALE PER GLI INCENTIVI ALLE IMPRESE   \n",
       "3                                                                                                                                        FONARCOM   \n",
       "4                                                                                                                                          FONDER   \n",
       "5                                                                                                                                    FONDO FOR.TE   \n",
       "6                                                                                                                                FONDOPROFESSIONI   \n",
       "7                                                       UNIONE REGIONALE DELLE CAMERE DI COMMERCIO INDUSTRIA ARTIGIANATO AGRICOLTURA DEL PIEMONTE   \n",
       "8                                                                                                                                     FONDIMPRESA   \n",
       "9                                                                                                                                         FONCOOP   \n",
       "\n",
       "   CONCESSIONI        NOMINALE           AIUTI  \n",
       "0       254432 1,427,160,166.0 1,427,160,166.0  \n",
       "1        14914 1,934,188,400.0   127,813,914.0  \n",
       "2         2796   125,965,619.0    89,876,791.0  \n",
       "3         1529     2,752,960.0     2,752,960.0  \n",
       "4         1117     1,710,921.0     1,618,699.0  \n",
       "5          768     4,851,253.0     4,851,253.0  \n",
       "6          606       579,084.0       575,934.0  \n",
       "7          560     8,765,133.0     8,765,133.0  \n",
       "8          552     7,712,030.0     7,712,030.0  \n",
       "9          531     5,685,118.0     5,685,118.0  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT upper(concedente) CONCEDENTE, count(CAR) CONCESSIONI, sum(cast(NOMINALE as integer)) NOMINALE, sum(cast(AIUTO as integer)) AIUTI FROM 'OpenData_Aiuti_2025_01.parquet' group by 1 order by 2 desc limit 10\").df()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b320f24d",
   "metadata": {},
   "source": [
    "## Gli aiuti in ordine di valore nominale €"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "abbbe8d3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CONCEDENTE</th>\n",
       "      <th>CONCESSIONI</th>\n",
       "      <th>NOMINALE</th>\n",
       "      <th>AIUTI</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>BANCA DEL MEZZOGIORNO MEDIOCREDITO CENTRALE S.P.A.</td>\n",
       "      <td>14914</td>\n",
       "      <td>1,934,188,400.0</td>\n",
       "      <td>127,813,914.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>INPS</td>\n",
       "      <td>254432</td>\n",
       "      <td>1,427,160,166.0</td>\n",
       "      <td>1,427,160,166.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>48</td>\n",
       "      <td>192,359,736.0</td>\n",
       "      <td>152,555,160.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>MINISTERO DELLE IMPRESE E DEL MADE IN ITALY - DIPARTIMENTO PER LE POLITICHE PER LE IMPRESE - DIREZIONE GENERALE PER GLI INCENTIVI ALLE IMPRESE</td>\n",
       "      <td>2796</td>\n",
       "      <td>125,965,619.0</td>\n",
       "      <td>89,876,791.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>INVITALIA - AGENZIA NAZIONALE PER L'ATTRAZIONE DEGLI INVESTIMENTI E LO SVILUPPO D'IMPRESA S.P.A.</td>\n",
       "      <td>299</td>\n",
       "      <td>102,743,941.0</td>\n",
       "      <td>78,368,900.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>REGIONE PUGLIA - DIPARTIMENTO SVILUPPO ECONOMICO</td>\n",
       "      <td>224</td>\n",
       "      <td>20,505,184.0</td>\n",
       "      <td>20,505,184.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>REGIONE AUTONOMA FRIULI VENEZIA GIULIA - DIREZIONE CENTRALE ATTIVITÀ PRODUTTIVE</td>\n",
       "      <td>66</td>\n",
       "      <td>18,257,297.0</td>\n",
       "      <td>3,121,015.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>INAIL - DIREZIONE CENTRALE PREVENZIONE</td>\n",
       "      <td>195</td>\n",
       "      <td>17,095,554.0</td>\n",
       "      <td>13,841,898.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>REGIONE PIEMONTE - DIREZIONE COORDINAMENTO POLITICHE E FONDI EUROPEI</td>\n",
       "      <td>449</td>\n",
       "      <td>14,386,187.0</td>\n",
       "      <td>14,386,187.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>REGIONE PIEMONTE - DIREZIONE AGRICOLTURA E CIBO</td>\n",
       "      <td>21</td>\n",
       "      <td>14,261,705.0</td>\n",
       "      <td>370,163.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                                                                                       CONCEDENTE  \\\n",
       "0                                                                                              BANCA DEL MEZZOGIORNO MEDIOCREDITO CENTRALE S.P.A.   \n",
       "1                                                                                                                                            INPS   \n",
       "2                                                                                                         GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "3  MINISTERO DELLE IMPRESE E DEL MADE IN ITALY - DIPARTIMENTO PER LE POLITICHE PER LE IMPRESE - DIREZIONE GENERALE PER GLI INCENTIVI ALLE IMPRESE   \n",
       "4                                                INVITALIA - AGENZIA NAZIONALE PER L'ATTRAZIONE DEGLI INVESTIMENTI E LO SVILUPPO D'IMPRESA S.P.A.   \n",
       "5                                                                                                REGIONE PUGLIA - DIPARTIMENTO SVILUPPO ECONOMICO   \n",
       "6                                                                 REGIONE AUTONOMA FRIULI VENEZIA GIULIA - DIREZIONE CENTRALE ATTIVITÀ PRODUTTIVE   \n",
       "7                                                                                                          INAIL - DIREZIONE CENTRALE PREVENZIONE   \n",
       "8                                                                            REGIONE PIEMONTE - DIREZIONE COORDINAMENTO POLITICHE E FONDI EUROPEI   \n",
       "9                                                                                                 REGIONE PIEMONTE - DIREZIONE AGRICOLTURA E CIBO   \n",
       "\n",
       "   CONCESSIONI        NOMINALE           AIUTI  \n",
       "0        14914 1,934,188,400.0   127,813,914.0  \n",
       "1       254432 1,427,160,166.0 1,427,160,166.0  \n",
       "2           48   192,359,736.0   152,555,160.0  \n",
       "3         2796   125,965,619.0    89,876,791.0  \n",
       "4          299   102,743,941.0    78,368,900.0  \n",
       "5          224    20,505,184.0    20,505,184.0  \n",
       "6           66    18,257,297.0     3,121,015.0  \n",
       "7          195    17,095,554.0    13,841,898.0  \n",
       "8          449    14,386,187.0    14,386,187.0  \n",
       "9           21    14,261,705.0       370,163.0  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT upper(concedente) CONCEDENTE, count(CAR) CONCESSIONI, sum(cast(NOMINALE as integer)) NOMINALE, sum(cast(AIUTO as integer)) AIUTI FROM 'OpenData_Aiuti_2025_01.parquet' group by 1 order by 3 desc limit 10\").df()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4b941cf4",
   "metadata": {},
   "source": [
    "## valori raggruppati per data "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "4166ca94",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CONCESSIONE</th>\n",
       "      <th>CONCESSIONI</th>\n",
       "      <th>NOMINALE</th>\n",
       "      <th>AIUTI</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2025-01-31</td>\n",
       "      <td>45421</td>\n",
       "      <td>561,196,693.0</td>\n",
       "      <td>278,277,081.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2025-01-30</td>\n",
       "      <td>36476</td>\n",
       "      <td>208,556,936.0</td>\n",
       "      <td>202,515,587.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2025-01-29</td>\n",
       "      <td>35686</td>\n",
       "      <td>132,254,858.0</td>\n",
       "      <td>128,777,052.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2025-01-28</td>\n",
       "      <td>11855</td>\n",
       "      <td>369,797,160.0</td>\n",
       "      <td>125,641,874.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2025-01-27</td>\n",
       "      <td>43586</td>\n",
       "      <td>350,755,398.0</td>\n",
       "      <td>343,786,019.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2025-01-26</td>\n",
       "      <td>9</td>\n",
       "      <td>2,704.0</td>\n",
       "      <td>2,704.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2025-01-25</td>\n",
       "      <td>44938</td>\n",
       "      <td>365,476,683.0</td>\n",
       "      <td>365,425,043.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2025-01-24</td>\n",
       "      <td>40995</td>\n",
       "      <td>561,494,057.0</td>\n",
       "      <td>264,903,743.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2025-01-23</td>\n",
       "      <td>12281</td>\n",
       "      <td>82,569,511.0</td>\n",
       "      <td>54,672,683.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2025-01-22</td>\n",
       "      <td>630</td>\n",
       "      <td>28,215,232.0</td>\n",
       "      <td>23,393,064.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2025-01-21</td>\n",
       "      <td>2774</td>\n",
       "      <td>333,887,613.0</td>\n",
       "      <td>39,562,598.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>2025-01-20</td>\n",
       "      <td>571</td>\n",
       "      <td>27,672,794.0</td>\n",
       "      <td>21,213,848.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2025-01-19</td>\n",
       "      <td>8</td>\n",
       "      <td>367,150.0</td>\n",
       "      <td>352,471.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2025-01-18</td>\n",
       "      <td>1</td>\n",
       "      <td>591.0</td>\n",
       "      <td>591.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2025-01-17</td>\n",
       "      <td>3523</td>\n",
       "      <td>311,049,601.0</td>\n",
       "      <td>48,535,073.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2025-01-16</td>\n",
       "      <td>645</td>\n",
       "      <td>34,591,334.0</td>\n",
       "      <td>21,170,260.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2025-01-15</td>\n",
       "      <td>925</td>\n",
       "      <td>16,099,176.0</td>\n",
       "      <td>9,931,627.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2025-01-14</td>\n",
       "      <td>2752</td>\n",
       "      <td>314,929,229.0</td>\n",
       "      <td>45,374,544.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2025-01-13</td>\n",
       "      <td>447</td>\n",
       "      <td>88,345,912.0</td>\n",
       "      <td>74,084,195.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>2025-01-11</td>\n",
       "      <td>40</td>\n",
       "      <td>1,580,484.0</td>\n",
       "      <td>1,245,577.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2025-01-10</td>\n",
       "      <td>2081</td>\n",
       "      <td>234,354,686.0</td>\n",
       "      <td>24,063,820.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2025-01-09</td>\n",
       "      <td>1214</td>\n",
       "      <td>30,778,080.0</td>\n",
       "      <td>22,413,430.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2025-01-08</td>\n",
       "      <td>374</td>\n",
       "      <td>14,845,848.0</td>\n",
       "      <td>12,419,061.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>2025-01-07</td>\n",
       "      <td>976</td>\n",
       "      <td>86,815,547.0</td>\n",
       "      <td>36,432,887.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>2025-01-06</td>\n",
       "      <td>5</td>\n",
       "      <td>50,002.0</td>\n",
       "      <td>50,002.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>2025-01-05</td>\n",
       "      <td>1</td>\n",
       "      <td>14,493.0</td>\n",
       "      <td>14,493.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>2025-01-04</td>\n",
       "      <td>23</td>\n",
       "      <td>520,966.0</td>\n",
       "      <td>520,966.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>2025-01-03</td>\n",
       "      <td>119</td>\n",
       "      <td>2,474,278.0</td>\n",
       "      <td>2,401,855.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>2025-01-02</td>\n",
       "      <td>124</td>\n",
       "      <td>39,363,816.0</td>\n",
       "      <td>22,420,932.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   CONCESSIONE  CONCESSIONI      NOMINALE         AIUTI\n",
       "0   2025-01-31        45421 561,196,693.0 278,277,081.0\n",
       "1   2025-01-30        36476 208,556,936.0 202,515,587.0\n",
       "2   2025-01-29        35686 132,254,858.0 128,777,052.0\n",
       "3   2025-01-28        11855 369,797,160.0 125,641,874.0\n",
       "4   2025-01-27        43586 350,755,398.0 343,786,019.0\n",
       "5   2025-01-26            9       2,704.0       2,704.0\n",
       "6   2025-01-25        44938 365,476,683.0 365,425,043.0\n",
       "7   2025-01-24        40995 561,494,057.0 264,903,743.0\n",
       "8   2025-01-23        12281  82,569,511.0  54,672,683.0\n",
       "9   2025-01-22          630  28,215,232.0  23,393,064.0\n",
       "10  2025-01-21         2774 333,887,613.0  39,562,598.0\n",
       "11  2025-01-20          571  27,672,794.0  21,213,848.0\n",
       "12  2025-01-19            8     367,150.0     352,471.0\n",
       "13  2025-01-18            1         591.0         591.0\n",
       "14  2025-01-17         3523 311,049,601.0  48,535,073.0\n",
       "15  2025-01-16          645  34,591,334.0  21,170,260.0\n",
       "16  2025-01-15          925  16,099,176.0   9,931,627.0\n",
       "17  2025-01-14         2752 314,929,229.0  45,374,544.0\n",
       "18  2025-01-13          447  88,345,912.0  74,084,195.0\n",
       "19  2025-01-11           40   1,580,484.0   1,245,577.0\n",
       "20  2025-01-10         2081 234,354,686.0  24,063,820.0\n",
       "21  2025-01-09         1214  30,778,080.0  22,413,430.0\n",
       "22  2025-01-08          374  14,845,848.0  12,419,061.0\n",
       "23  2025-01-07          976  86,815,547.0  36,432,887.0\n",
       "24  2025-01-06            5      50,002.0      50,002.0\n",
       "25  2025-01-05            1      14,493.0      14,493.0\n",
       "26  2025-01-04           23     520,966.0     520,966.0\n",
       "27  2025-01-03          119   2,474,278.0   2,401,855.0\n",
       "28  2025-01-02          124  39,363,816.0  22,420,932.0"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT CONCESSIONE, count(CAR) CONCESSIONI, sum(cast(NOMINALE as integer)) NOMINALE, sum(cast(AIUTO as integer)) AIUTI FROM 'OpenData_Aiuti_2025_01.parquet' group by 1 order by 1 desc\").df()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "49448768",
   "metadata": {},
   "source": [
    "### valori raggruppati per regione "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "016165a8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>REGIONE</th>\n",
       "      <th>count(CAR)</th>\n",
       "      <th>sum(CAST(NOMINALE AS INTEGER))</th>\n",
       "      <th>sum(CAST(AIUTO AS INTEGER))</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>LOMBARDIA</td>\n",
       "      <td>49892</td>\n",
       "      <td>873,593,711.0</td>\n",
       "      <td>545,073,929.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CAMPANIA</td>\n",
       "      <td>31179</td>\n",
       "      <td>392,387,204.0</td>\n",
       "      <td>172,188,255.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>VENETO</td>\n",
       "      <td>24454</td>\n",
       "      <td>372,076,854.0</td>\n",
       "      <td>179,851,953.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>PIEMONTE</td>\n",
       "      <td>17998</td>\n",
       "      <td>326,266,290.0</td>\n",
       "      <td>151,577,391.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>LAZIO</td>\n",
       "      <td>22051</td>\n",
       "      <td>316,076,119.0</td>\n",
       "      <td>163,111,372.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>EMILIA-ROMAGNA</td>\n",
       "      <td>20436</td>\n",
       "      <td>295,503,890.0</td>\n",
       "      <td>168,523,740.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>PUGLIA</td>\n",
       "      <td>21462</td>\n",
       "      <td>275,952,282.0</td>\n",
       "      <td>128,651,247.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>SICILIA</td>\n",
       "      <td>24128</td>\n",
       "      <td>258,160,221.0</td>\n",
       "      <td>113,920,615.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>TOSCANA</td>\n",
       "      <td>16063</td>\n",
       "      <td>224,343,793.0</td>\n",
       "      <td>106,355,032.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>FRIULI-VENEZIA GIULIA</td>\n",
       "      <td>6176</td>\n",
       "      <td>127,429,098.0</td>\n",
       "      <td>80,238,575.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 REGIONE  count(CAR)  sum(CAST(NOMINALE AS INTEGER))  \\\n",
       "0              LOMBARDIA       49892                   873,593,711.0   \n",
       "1               CAMPANIA       31179                   392,387,204.0   \n",
       "2                 VENETO       24454                   372,076,854.0   \n",
       "3               PIEMONTE       17998                   326,266,290.0   \n",
       "4                  LAZIO       22051                   316,076,119.0   \n",
       "5         EMILIA-ROMAGNA       20436                   295,503,890.0   \n",
       "6                 PUGLIA       21462                   275,952,282.0   \n",
       "7                SICILIA       24128                   258,160,221.0   \n",
       "8                TOSCANA       16063                   224,343,793.0   \n",
       "9  FRIULI-VENEZIA GIULIA        6176                   127,429,098.0   \n",
       "\n",
       "   sum(CAST(AIUTO AS INTEGER))  \n",
       "0                545,073,929.0  \n",
       "1                172,188,255.0  \n",
       "2                179,851,953.0  \n",
       "3                151,577,391.0  \n",
       "4                163,111,372.0  \n",
       "5                168,523,740.0  \n",
       "6                128,651,247.0  \n",
       "7                113,920,615.0  \n",
       "8                106,355,032.0  \n",
       "9                 80,238,575.0  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT upper(REGIONE) REGIONE, count(CAR), sum(cast(NOMINALE as integer)), sum(cast(AIUTO as integer)) FROM 'OpenData_Aiuti_2025_01.parquet' group by 1 order by 3 desc limit 10\").df()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "da581cef",
   "metadata": {},
   "source": [
    "### valori raggruppati per ATECO "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1987e8bf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SETTORE_ATTIVITA</th>\n",
       "      <th>count(CAR)</th>\n",
       "      <th>sum(CAST(NOMINALE AS INTEGER))</th>\n",
       "      <th>sum(CAST(AIUTO AS INTEGER))</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>F.41.2</td>\n",
       "      <td>9287</td>\n",
       "      <td>163,293,794.0</td>\n",
       "      <td>48,573,220.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>D.35.1</td>\n",
       "      <td>523</td>\n",
       "      <td>148,851,639.0</td>\n",
       "      <td>80,323,869.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>I.56.1</td>\n",
       "      <td>20292</td>\n",
       "      <td>144,082,919.0</td>\n",
       "      <td>82,794,010.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>F.43.2</td>\n",
       "      <td>10835</td>\n",
       "      <td>126,596,444.0</td>\n",
       "      <td>59,673,120.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>J.62.0</td>\n",
       "      <td>6811</td>\n",
       "      <td>117,881,630.0</td>\n",
       "      <td>83,690,826.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>H.49.4</td>\n",
       "      <td>5105</td>\n",
       "      <td>117,519,650.0</td>\n",
       "      <td>35,566,283.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>G.47.7</td>\n",
       "      <td>13507</td>\n",
       "      <td>97,903,520.0</td>\n",
       "      <td>57,478,971.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>D.35.2</td>\n",
       "      <td>97</td>\n",
       "      <td>94,972,219.0</td>\n",
       "      <td>90,234,671.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>G.46.4</td>\n",
       "      <td>4646</td>\n",
       "      <td>94,557,197.0</td>\n",
       "      <td>27,224,214.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>I.55.1</td>\n",
       "      <td>3550</td>\n",
       "      <td>88,270,063.0</td>\n",
       "      <td>36,006,125.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  SETTORE_ATTIVITA  count(CAR)  sum(CAST(NOMINALE AS INTEGER))  \\\n",
       "0           F.41.2        9287                   163,293,794.0   \n",
       "1           D.35.1         523                   148,851,639.0   \n",
       "2           I.56.1       20292                   144,082,919.0   \n",
       "3           F.43.2       10835                   126,596,444.0   \n",
       "4           J.62.0        6811                   117,881,630.0   \n",
       "5           H.49.4        5105                   117,519,650.0   \n",
       "6           G.47.7       13507                    97,903,520.0   \n",
       "7           D.35.2          97                    94,972,219.0   \n",
       "8           G.46.4        4646                    94,557,197.0   \n",
       "9           I.55.1        3550                    88,270,063.0   \n",
       "\n",
       "   sum(CAST(AIUTO AS INTEGER))  \n",
       "0                 48,573,220.0  \n",
       "1                 80,323,869.0  \n",
       "2                 82,794,010.0  \n",
       "3                 59,673,120.0  \n",
       "4                 83,690,826.0  \n",
       "5                 35,566,283.0  \n",
       "6                 57,478,971.0  \n",
       "7                 90,234,671.0  \n",
       "8                 27,224,214.0  \n",
       "9                 36,006,125.0  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT upper(SETTORE_ATTIVITA) SETTORE_ATTIVITA, count(CAR), sum(cast(NOMINALE as integer)), sum(cast(AIUTO as integer)) FROM 'OpenData_Aiuti_2025_01.parquet' group by 1 order by 3 desc limit 10\").df()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f91061da",
   "metadata": {},
   "source": [
    "### valori raggruppati per strumento "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "d6cbe496",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>STRUMENTO</th>\n",
       "      <th>count(CAR)</th>\n",
       "      <th>sum(CAST(NOMINALE AS INTEGER))</th>\n",
       "      <th>sum(CAST(AIUTO AS INTEGER))</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AGEVOLAZIONE FISCALE O ESENZIONE FISCALE</td>\n",
       "      <td>254746</td>\n",
       "      <td>1,442,732,051.0</td>\n",
       "      <td>1,442,123,047.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>SOVVENZIONE/CONTRIBUTO IN CONTO INTERESSI</td>\n",
       "      <td>16696</td>\n",
       "      <td>544,531,517.0</td>\n",
       "      <td>449,595,824.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GARANZIA (SE DEL CASO CON UN RIFERIMENTO ALLA DECISIONE DELLA COMMISSIONE (10))</td>\n",
       "      <td>15473</td>\n",
       "      <td>1,976,479,946.0</td>\n",
       "      <td>129,662,953.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>PRESTITO/ANTICIPO RIMBORSABILE</td>\n",
       "      <td>495</td>\n",
       "      <td>106,765,282.0</td>\n",
       "      <td>26,157,762.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>SCONTO PER PARTECIPAZIONE A INIZIATIVE PROGRAMMATE (CATEGORIA: SOVVENZIONE/CONTRIBUTO IN CONTO INTERESSI)</td>\n",
       "      <td>449</td>\n",
       "      <td>14,386,187.0</td>\n",
       "      <td>14,386,187.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>EROGAZIONE SERVIZI (CATEGORIA: SOVVENZIONE/CONTRIBUTO IN CONTO INTERESSI)</td>\n",
       "      <td>188</td>\n",
       "      <td>2,729,160.0</td>\n",
       "      <td>2,176,276.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>MISURA PER IL FINANZIAMENTO DEL RISCHIO</td>\n",
       "      <td>103</td>\n",
       "      <td>9,039,541.0</td>\n",
       "      <td>7,376,896.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>CONTO CAPITALE A FONDO PERDUTO (CATEGORIA: MISURA PER IL FINANZIAMENTO DEL RISCHIO)</td>\n",
       "      <td>71</td>\n",
       "      <td>6,646,324.0</td>\n",
       "      <td>5,209,815.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>CONTRIBUTO A FONDO PERDUTO (CATEGORIA: SOVVENZIONE/CONTRIBUTO IN CONTO INTERESSI)</td>\n",
       "      <td>62</td>\n",
       "      <td>4,285,651.0</td>\n",
       "      <td>3,004,296.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>SCONTO SUL CANONE DI CONNETTIVITÀ (CATEGORIA: SOVVENZIONE/CONTRIBUTO IN CONTO INTERESSI)</td>\n",
       "      <td>45</td>\n",
       "      <td>70,750.0</td>\n",
       "      <td>70,750.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                                                   STRUMENTO  \\\n",
       "0                                                                   AGEVOLAZIONE FISCALE O ESENZIONE FISCALE   \n",
       "1                                                                  SOVVENZIONE/CONTRIBUTO IN CONTO INTERESSI   \n",
       "2                            GARANZIA (SE DEL CASO CON UN RIFERIMENTO ALLA DECISIONE DELLA COMMISSIONE (10))   \n",
       "3                                                                             PRESTITO/ANTICIPO RIMBORSABILE   \n",
       "4  SCONTO PER PARTECIPAZIONE A INIZIATIVE PROGRAMMATE (CATEGORIA: SOVVENZIONE/CONTRIBUTO IN CONTO INTERESSI)   \n",
       "5                                  EROGAZIONE SERVIZI (CATEGORIA: SOVVENZIONE/CONTRIBUTO IN CONTO INTERESSI)   \n",
       "6                                                                    MISURA PER IL FINANZIAMENTO DEL RISCHIO   \n",
       "7                        CONTO CAPITALE A FONDO PERDUTO (CATEGORIA: MISURA PER IL FINANZIAMENTO DEL RISCHIO)   \n",
       "8                          CONTRIBUTO A FONDO PERDUTO (CATEGORIA: SOVVENZIONE/CONTRIBUTO IN CONTO INTERESSI)   \n",
       "9                   SCONTO SUL CANONE DI CONNETTIVITÀ (CATEGORIA: SOVVENZIONE/CONTRIBUTO IN CONTO INTERESSI)   \n",
       "\n",
       "   count(CAR)  sum(CAST(NOMINALE AS INTEGER))  sum(CAST(AIUTO AS INTEGER))  \n",
       "0      254746                 1,442,732,051.0              1,442,123,047.0  \n",
       "1       16696                   544,531,517.0                449,595,824.0  \n",
       "2       15473                 1,976,479,946.0                129,662,953.0  \n",
       "3         495                   106,765,282.0                 26,157,762.0  \n",
       "4         449                    14,386,187.0                 14,386,187.0  \n",
       "5         188                     2,729,160.0                  2,176,276.0  \n",
       "6         103                     9,039,541.0                  7,376,896.0  \n",
       "7          71                     6,646,324.0                  5,209,815.0  \n",
       "8          62                     4,285,651.0                  3,004,296.0  \n",
       "9          45                        70,750.0                     70,750.0  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT upper(DES_STRUMENTO) STRUMENTO, count(CAR), sum(cast(NOMINALE as integer)), sum(cast(AIUTO as integer)) FROM 'OpenData_Aiuti_2025_01.parquet' group by 1 order by 2 desc limit 10\").df()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "10c7c7b1",
   "metadata": {},
   "source": [
    "### gli importi più grandi "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "66d064a1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>IMPRESA</th>\n",
       "      <th>REGIONE</th>\n",
       "      <th>CONCEDENTE</th>\n",
       "      <th>MISURA</th>\n",
       "      <th>NOMINALE</th>\n",
       "      <th>AIUTO</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>BIOWASTE CH4 LEGNANO S.R.L.</td>\n",
       "      <td>Lombardia</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Decreto 2 marzo 2018: Promozione dell’uso del biometano e degli altri biocarburanti avanzati nel settore dei trasporti (GU n.65 del 19/3/2018)</td>\n",
       "      <td>32,489,271.33</td>\n",
       "      <td>32,489,271.33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ENIBIOCH4IN QUADRUVIUM - S.R.L. SOCIETA' AGRICOLA</td>\n",
       "      <td>Friuli-Venezia Giulia</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Decreto 2 marzo 2018: Promozione dell’uso del biometano e degli altri biocarburanti avanzati nel settore dei trasporti (GU n.65 del 19/3/2018)</td>\n",
       "      <td>27,020,243.99</td>\n",
       "      <td>27,020,243.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AMBIENTE &amp; RISORSE SRL</td>\n",
       "      <td>Lombardia</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Decreto 2 marzo 2018: Promozione dell’uso del biometano e degli altri biocarburanti avanzati nel settore dei trasporti (GU n.65 del 19/3/2018)</td>\n",
       "      <td>25,720,673.14</td>\n",
       "      <td>25,720,673.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ENGIE SERVIZI S.P.A.</td>\n",
       "      <td>Lazio</td>\n",
       "      <td>REGIONE LAZIO</td>\n",
       "      <td>Regime di aiuti agli investimenti per la produzione di idrogeno rinnovabile in aree industriali dismesse – PNRR M2C2 Investimento 3.1</td>\n",
       "      <td>12,000,000.0</td>\n",
       "      <td>12,000,000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>SOCIETA' AGRICOLA LORENZO S.S. DI ODETTO ALEX E LUCA</td>\n",
       "      <td>Piemonte</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici</td>\n",
       "      <td>10,122,866.0</td>\n",
       "      <td>5,568,880.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>RANDSTAD ITALIA S.P.A.</td>\n",
       "      <td>Lombardia</td>\n",
       "      <td>INPS</td>\n",
       "      <td>Esonero dal versamento dei contributi previdenziali per nuove assunzioni/trasformazioni a tempo indeterminato nel biennio 2021 - 2022 (art. 1 commi 10 - 15 L. 178/2020)</td>\n",
       "      <td>9,490,693.25</td>\n",
       "      <td>9,490,693.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>SAN GIORGIO DI CONTI GIORGIO &amp; C. S.S. SOCIETA' AGRICOLA</td>\n",
       "      <td>Lombardia</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici</td>\n",
       "      <td>8,859,626.0</td>\n",
       "      <td>4,873,935.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>AZ.AGRIC. CORTAZZA DI RIBONI GIOVANNI E LUIGI SOCIETA' AGRICOLA S S.</td>\n",
       "      <td>Lombardia</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici</td>\n",
       "      <td>8,859,626.0</td>\n",
       "      <td>4,873,935.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>SOCIETA' AGRICOLA LE GAZZE</td>\n",
       "      <td>Lombardia</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici</td>\n",
       "      <td>8,859,626.0</td>\n",
       "      <td>4,873,935.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>BELLINI ANTONIO E FACCHI ANNA SOCIETA' AGRICOLA S.S.</td>\n",
       "      <td>Lombardia</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici</td>\n",
       "      <td>8,859,626.0</td>\n",
       "      <td>4,873,935.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>SOCIETA' AGRICOLA LANFREDI SOCIETA' SEMPLICE</td>\n",
       "      <td>Lombardia</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici</td>\n",
       "      <td>8,859,626.0</td>\n",
       "      <td>4,775,453.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>SECCAMANI GIOVANNI, CRISTOFORO E ANTONIO SOCIETA' AGRICOLA S.S.</td>\n",
       "      <td>Lombardia</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici</td>\n",
       "      <td>8,401,979.0</td>\n",
       "      <td>4,622,170.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>SISTEMI ENERGETICI S.P.A.</td>\n",
       "      <td>Puglia</td>\n",
       "      <td>REGIONE PUGLIA</td>\n",
       "      <td>Regime di aiuti agli investimenti per la produzione di idrogeno rinnovabile in aree industriali dismesse – PNRR M2C2 Investimento 3.1</td>\n",
       "      <td>8,000,000.0</td>\n",
       "      <td>8,000,000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>POSTE ITALIANE - SOCIETA' PER AZIONI</td>\n",
       "      <td>Lazio</td>\n",
       "      <td>INPS</td>\n",
       "      <td>Esonero dal versamento dei contributi previdenziali per nuove assunzioni/trasformazioni a tempo indeterminato nel biennio 2021 - 2022 (art. 1 commi 10 - 15 L. 178/2020)</td>\n",
       "      <td>7,898,565.89</td>\n",
       "      <td>7,898,565.89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>SCOGLIO DELLA GALEA</td>\n",
       "      <td>Calabria</td>\n",
       "      <td>INVITALIA - AGENZIA NAZIONALE PER L'ATTRAZIONE DEGLI INVESTIMENTI E LO SVILUPPO D'IMPRESA S.P.A.</td>\n",
       "      <td>Contratti di sviluppo di cui all'articolo 43 del decreto-legge 25 giugno 2008, n.112, convertito dalla legge 6 agosto 2008, n. 133 (adeguamento GBER e proroga 2026)</td>\n",
       "      <td>7,100,824.97</td>\n",
       "      <td>7,100,824.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>MACCHIORLATTI VIGNAT F.LLI SOCIETA' SEMPLICE AGRICOLA</td>\n",
       "      <td>Piemonte</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici</td>\n",
       "      <td>6,201,739.0</td>\n",
       "      <td>3,342,817.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>AZIMUT - BENETTI S.P.A.</td>\n",
       "      <td>Liguria, Piemonte, Toscana</td>\n",
       "      <td>MINISTERO DELLE IMPRESE E DEL MADE IN ITALY - DIPARTIMENTO PER LE POLITICHE PER LE IMPRESE - DIREZIONE GENERALE PER GLI INCENTIVI ALLE IMPRESE</td>\n",
       "      <td>Green New Deal</td>\n",
       "      <td>6,108,075.0</td>\n",
       "      <td>871,919.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>AZIMUT - BENETTI S.P.A.</td>\n",
       "      <td>Liguria, Piemonte, Toscana</td>\n",
       "      <td>MINISTERO DELLE IMPRESE E DEL MADE IN ITALY - DIPARTIMENTO PER LE POLITICHE PER LE IMPRESE - DIREZIONE GENERALE PER GLI INCENTIVI ALLE IMPRESE</td>\n",
       "      <td>Green New Deal</td>\n",
       "      <td>5,891,925.0</td>\n",
       "      <td>954,225.64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>CASEIFICI GRANTERRE</td>\n",
       "      <td>Emilia-Romagna</td>\n",
       "      <td>INVITALIA - AGENZIA NAZIONALE PER L'ATTRAZIONE DEGLI INVESTIMENTI E LO SVILUPPO D'IMPRESA S.P.A.</td>\n",
       "      <td>Contratti di sviluppo agroindustriali - 2023</td>\n",
       "      <td>5,659,164.0</td>\n",
       "      <td>5,659,164.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>CAMPIDANO AGROZOOTECNICA SOCIETA' AGRICOLA A R.L.</td>\n",
       "      <td>Sardegna</td>\n",
       "      <td>GSE - GESTORE SERVIZI ENERGETICI S.P.A.</td>\n",
       "      <td>Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici</td>\n",
       "      <td>5,408,350.0</td>\n",
       "      <td>3,005,000.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                 IMPRESA  \\\n",
       "0                                            BIOWASTE CH4 LEGNANO S.R.L.   \n",
       "1                      ENIBIOCH4IN QUADRUVIUM - S.R.L. SOCIETA' AGRICOLA   \n",
       "2                                                 AMBIENTE & RISORSE SRL   \n",
       "3                                                   ENGIE SERVIZI S.P.A.   \n",
       "4                   SOCIETA' AGRICOLA LORENZO S.S. DI ODETTO ALEX E LUCA   \n",
       "5                                                 RANDSTAD ITALIA S.P.A.   \n",
       "6               SAN GIORGIO DI CONTI GIORGIO & C. S.S. SOCIETA' AGRICOLA   \n",
       "7   AZ.AGRIC. CORTAZZA DI RIBONI GIOVANNI E LUIGI SOCIETA' AGRICOLA S S.   \n",
       "8                                             SOCIETA' AGRICOLA LE GAZZE   \n",
       "9                   BELLINI ANTONIO E FACCHI ANNA SOCIETA' AGRICOLA S.S.   \n",
       "10                          SOCIETA' AGRICOLA LANFREDI SOCIETA' SEMPLICE   \n",
       "11       SECCAMANI GIOVANNI, CRISTOFORO E ANTONIO SOCIETA' AGRICOLA S.S.   \n",
       "12                                             SISTEMI ENERGETICI S.P.A.   \n",
       "13                                  POSTE ITALIANE - SOCIETA' PER AZIONI   \n",
       "14                                                  SCOGLIO DELLA GALEA    \n",
       "15                 MACCHIORLATTI VIGNAT F.LLI SOCIETA' SEMPLICE AGRICOLA   \n",
       "16                                               AZIMUT - BENETTI S.P.A.   \n",
       "17                                               AZIMUT - BENETTI S.P.A.   \n",
       "18                                                   CASEIFICI GRANTERRE   \n",
       "19                     CAMPIDANO AGROZOOTECNICA SOCIETA' AGRICOLA A R.L.   \n",
       "\n",
       "                       REGIONE  \\\n",
       "0                    Lombardia   \n",
       "1        Friuli-Venezia Giulia   \n",
       "2                    Lombardia   \n",
       "3                        Lazio   \n",
       "4                     Piemonte   \n",
       "5                    Lombardia   \n",
       "6                    Lombardia   \n",
       "7                    Lombardia   \n",
       "8                    Lombardia   \n",
       "9                    Lombardia   \n",
       "10                   Lombardia   \n",
       "11                   Lombardia   \n",
       "12                      Puglia   \n",
       "13                       Lazio   \n",
       "14                    Calabria   \n",
       "15                    Piemonte   \n",
       "16  Liguria, Piemonte, Toscana   \n",
       "17  Liguria, Piemonte, Toscana   \n",
       "18              Emilia-Romagna   \n",
       "19                    Sardegna   \n",
       "\n",
       "                                                                                                                                        CONCEDENTE  \\\n",
       "0                                                                                                          GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "1                                                                                                          GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "2                                                                                                          GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "3                                                                                                                                    REGIONE LAZIO   \n",
       "4                                                                                                          GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "5                                                                                                                                             INPS   \n",
       "6                                                                                                          GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "7                                                                                                          GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "8                                                                                                          GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "9                                                                                                          GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "10                                                                                                         GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "11                                                                                                         GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "12                                                                                                                                  REGIONE PUGLIA   \n",
       "13                                                                                                                                            INPS   \n",
       "14                                                INVITALIA - AGENZIA NAZIONALE PER L'ATTRAZIONE DEGLI INVESTIMENTI E LO SVILUPPO D'IMPRESA S.P.A.   \n",
       "15                                                                                                         GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "16  MINISTERO DELLE IMPRESE E DEL MADE IN ITALY - DIPARTIMENTO PER LE POLITICHE PER LE IMPRESE - DIREZIONE GENERALE PER GLI INCENTIVI ALLE IMPRESE   \n",
       "17  MINISTERO DELLE IMPRESE E DEL MADE IN ITALY - DIPARTIMENTO PER LE POLITICHE PER LE IMPRESE - DIREZIONE GENERALE PER GLI INCENTIVI ALLE IMPRESE   \n",
       "18                                                INVITALIA - AGENZIA NAZIONALE PER L'ATTRAZIONE DEGLI INVESTIMENTI E LO SVILUPPO D'IMPRESA S.P.A.   \n",
       "19                                                                                                         GSE - GESTORE SERVIZI ENERGETICI S.P.A.   \n",
       "\n",
       "                                                                                                                                                                      MISURA  \\\n",
       "0                             Decreto 2 marzo 2018: Promozione dell’uso del biometano e degli altri biocarburanti avanzati nel settore dei trasporti (GU n.65 del 19/3/2018)   \n",
       "1                             Decreto 2 marzo 2018: Promozione dell’uso del biometano e degli altri biocarburanti avanzati nel settore dei trasporti (GU n.65 del 19/3/2018)   \n",
       "2                             Decreto 2 marzo 2018: Promozione dell’uso del biometano e degli altri biocarburanti avanzati nel settore dei trasporti (GU n.65 del 19/3/2018)   \n",
       "3                                      Regime di aiuti agli investimenti per la produzione di idrogeno rinnovabile in aree industriali dismesse – PNRR M2C2 Investimento 3.1   \n",
       "4                                               Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici   \n",
       "5   Esonero dal versamento dei contributi previdenziali per nuove assunzioni/trasformazioni a tempo indeterminato nel biennio 2021 - 2022 (art. 1 commi 10 - 15 L. 178/2020)   \n",
       "6                                               Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici   \n",
       "7                                               Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici   \n",
       "8                                               Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici   \n",
       "9                                               Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici   \n",
       "10                                              Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici   \n",
       "11                                              Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici   \n",
       "12                                     Regime di aiuti agli investimenti per la produzione di idrogeno rinnovabile in aree industriali dismesse – PNRR M2C2 Investimento 3.1   \n",
       "13  Esonero dal versamento dei contributi previdenziali per nuove assunzioni/trasformazioni a tempo indeterminato nel biennio 2021 - 2022 (art. 1 commi 10 - 15 L. 178/2020)   \n",
       "14      Contratti di sviluppo di cui all'articolo 43 del decreto-legge 25 giugno 2008, n.112, convertito dalla legge 6 agosto 2008, n. 133 (adeguamento GBER e proroga 2026)   \n",
       "15                                              Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici   \n",
       "16                                                                                                                                                            Green New Deal   \n",
       "17                                                                                                                                                            Green New Deal   \n",
       "18                                                                                                                              Contratti di sviluppo agroindustriali - 2023   \n",
       "19                                              Incentivazione dell'energia prodotta da impianti a biogas da reflui e materie derivanti dalle aziende agricole realizzatrici   \n",
       "\n",
       "        NOMINALE         AIUTO  \n",
       "0  32,489,271.33 32,489,271.33  \n",
       "1  27,020,243.99 27,020,243.99  \n",
       "2  25,720,673.14 25,720,673.14  \n",
       "3   12,000,000.0  12,000,000.0  \n",
       "4   10,122,866.0   5,568,880.0  \n",
       "5   9,490,693.25  9,490,693.25  \n",
       "6    8,859,626.0   4,873,935.0  \n",
       "7    8,859,626.0   4,873,935.0  \n",
       "8    8,859,626.0   4,873,935.0  \n",
       "9    8,859,626.0   4,873,935.0  \n",
       "10   8,859,626.0   4,775,453.0  \n",
       "11   8,401,979.0   4,622,170.0  \n",
       "12   8,000,000.0   8,000,000.0  \n",
       "13  7,898,565.89  7,898,565.89  \n",
       "14  7,100,824.97  7,100,824.97  \n",
       "15   6,201,739.0   3,342,817.0  \n",
       "16   6,108,075.0     871,919.6  \n",
       "17   5,891,925.0    954,225.64  \n",
       "18   5,659,164.0   5,659,164.0  \n",
       "19   5,408,350.0   3,005,000.0  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT IMPRESA, REGIONE, CONCEDENTE, MISURA, NOMINALE, AIUTO FROM 'OpenData_Aiuti_2025_01.parquet' order by 5 desc limit 20\").df()\n",
    "df"
   ]
  },
  {
   "cell_type": "raw",
   "id": "f0fd3859",
   "metadata": {},
   "source": [
    "---"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a964803",
   "metadata": {},
   "source": [
    "## Analisi per concedente\n",
    "\n",
    "Il nome del concedente viene scritto in modi diversi; non c' il suo codice fiscale o la sua P.IVA\n",
    "\n",
    "### Un esempio: gli aiuti concessi da Invitalia\n",
    "- INVITALIA - AGENZIA NAZIONALE PER L'ATTRAZIONE DEGLI INVESTIMENTI E LO SVILUPPO D'IMPRESA S.P.A.\n",
    "- AGENZIA NAZIONALE PER L'ATTRAZIONE DEGLI INVESTIMENTI E LO SVILUPPO D'IMPRESA SPA - INVITALIA (05678721001)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "9e947ccc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>MISURA</th>\n",
       "      <th>CONCESSIONI</th>\n",
       "      <th>NOMINALE</th>\n",
       "      <th>AIUTI</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>INVESTIMENTI SOSTENIBILI 4.0 (PN RIC 2021-2027)</td>\n",
       "      <td>68</td>\n",
       "      <td>50,350,162.0</td>\n",
       "      <td>32,502,255.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CONTRATTI DI SVILUPPO DI CUI ALL'ARTICOLO 43 DEL DECRETO-LEGGE 25 GIUGNO 2008, N.112, CONVERTITO DALLA LEGGE 6 AGOSTO 2008, N. 133 (ADEGUAMENTO GBER E PROROGA 2026)</td>\n",
       "      <td>6</td>\n",
       "      <td>18,240,078.0</td>\n",
       "      <td>18,240,078.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>FONDO PER IL SOSTEGNO ALLA TRANSIZIONE INDUSTRIALE</td>\n",
       "      <td>10</td>\n",
       "      <td>12,759,588.0</td>\n",
       "      <td>12,759,588.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4:2:5 FONDO ROTATIVO IMPRESE (FRI) PER IL SOSTEGNO ALLE IMPRESE E GLI INVESTIMENTI DI SVILUPPO</td>\n",
       "      <td>39</td>\n",
       "      <td>8,856,020.0</td>\n",
       "      <td>8,144,283.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NIT0 - NUOVE IMPRESE A TASSO ZERO</td>\n",
       "      <td>60</td>\n",
       "      <td>7,021,985.0</td>\n",
       "      <td>3,466,904.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>CONTRATTI DI SVILUPPO AGROINDUSTRIALI - 2023</td>\n",
       "      <td>1</td>\n",
       "      <td>5,659,164.0</td>\n",
       "      <td>5,659,164.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>PNRR, M1C3 INVESTIMENTI 4.2.1; 4.2.2 AVVISO PUBBLICO EX ARTT. 1 E 4 DL 152/2021</td>\n",
       "      <td>79</td>\n",
       "      <td>5,176,411.0</td>\n",
       "      <td>4,636,411.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>SMART&amp;START - RIORDINO DEGLI INTERVENTI DI SOSTEGNO ALLA NASCITA E ALLO SVILUPPO DI START-UP INNOVATIVE IN TUTTO IL TERRITORIO NAZIONALE - VERSIONE MODIFICATA DAL CODICE CE SA.55753</td>\n",
       "      <td>13</td>\n",
       "      <td>4,243,242.0</td>\n",
       "      <td>2,056,740.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>RESTO AL SUD</td>\n",
       "      <td>84</td>\n",
       "      <td>2,654,480.0</td>\n",
       "      <td>2,612,698.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>MAGGIORAZIONE DEL CONTRIBUTO PER L'ACQUISTO DI VEICOLI DI CATEGORIA M1 DA PARTE DEI TITOLARI DI LICENZE DI TAXI E DI SOGGETTI AUTORIZZATI ALL'ESERCIZIO DEL SERVIZIO DI NOLEGGIO CON CONDUCENTE (\"ECOBONUS TAXI\")</td>\n",
       "      <td>29</td>\n",
       "      <td>963,429.0</td>\n",
       "      <td>358,000.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                                                                                                                                                              MISURA  \\\n",
       "0                                                                                                                                                                    INVESTIMENTI SOSTENIBILI 4.0 (PN RIC 2021-2027)   \n",
       "1                                               CONTRATTI DI SVILUPPO DI CUI ALL'ARTICOLO 43 DEL DECRETO-LEGGE 25 GIUGNO 2008, N.112, CONVERTITO DALLA LEGGE 6 AGOSTO 2008, N. 133 (ADEGUAMENTO GBER E PROROGA 2026)   \n",
       "2                                                                                                                                                                 FONDO PER IL SOSTEGNO ALLA TRANSIZIONE INDUSTRIALE   \n",
       "3                                                                                                                     4:2:5 FONDO ROTATIVO IMPRESE (FRI) PER IL SOSTEGNO ALLE IMPRESE E GLI INVESTIMENTI DI SVILUPPO   \n",
       "4                                                                                                                                                                                  NIT0 - NUOVE IMPRESE A TASSO ZERO   \n",
       "5                                                                                                                                                                       CONTRATTI DI SVILUPPO AGROINDUSTRIALI - 2023   \n",
       "6                                                                                                                                    PNRR, M1C3 INVESTIMENTI 4.2.1; 4.2.2 AVVISO PUBBLICO EX ARTT. 1 E 4 DL 152/2021   \n",
       "7                              SMART&START - RIORDINO DEGLI INTERVENTI DI SOSTEGNO ALLA NASCITA E ALLO SVILUPPO DI START-UP INNOVATIVE IN TUTTO IL TERRITORIO NAZIONALE - VERSIONE MODIFICATA DAL CODICE CE SA.55753   \n",
       "8                                                                                                                                                                                                       RESTO AL SUD   \n",
       "9  MAGGIORAZIONE DEL CONTRIBUTO PER L'ACQUISTO DI VEICOLI DI CATEGORIA M1 DA PARTE DEI TITOLARI DI LICENZE DI TAXI E DI SOGGETTI AUTORIZZATI ALL'ESERCIZIO DEL SERVIZIO DI NOLEGGIO CON CONDUCENTE (\"ECOBONUS TAXI\")   \n",
       "\n",
       "   CONCESSIONI     NOMINALE        AIUTI  \n",
       "0           68 50,350,162.0 32,502,255.0  \n",
       "1            6 18,240,078.0 18,240,078.0  \n",
       "2           10 12,759,588.0 12,759,588.0  \n",
       "3           39  8,856,020.0  8,144,283.0  \n",
       "4           60  7,021,985.0  3,466,904.0  \n",
       "5            1  5,659,164.0  5,659,164.0  \n",
       "6           79  5,176,411.0  4,636,411.0  \n",
       "7           13  4,243,242.0  2,056,740.0  \n",
       "8           84  2,654,480.0  2,612,698.0  \n",
       "9           29    963,429.0    358,000.0  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT upper(misura) MISURA, count(CAR) CONCESSIONI, sum(cast(NOMINALE as integer)) NOMINALE, sum(cast(AIUTO as integer)) AIUTI FROM 'OpenData_Aiuti_2025_01.parquet' where concedente like '%INVI%' group by 1 order by 3 desc limit 10\").df()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1dbddcfd",
   "metadata": {},
   "source": [
    "### valori raggruppati per data "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "aa8b03e2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CONCESSIONE</th>\n",
       "      <th>CONCESSIONI</th>\n",
       "      <th>NOMINALE</th>\n",
       "      <th>AIUTI</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2025-01-31</td>\n",
       "      <td>32</td>\n",
       "      <td>12,053,460.0</td>\n",
       "      <td>9,138,731.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2025-01-30</td>\n",
       "      <td>31</td>\n",
       "      <td>2,126,257.0</td>\n",
       "      <td>1,895,920.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2025-01-29</td>\n",
       "      <td>2</td>\n",
       "      <td>18,000.0</td>\n",
       "      <td>18,000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2025-01-28</td>\n",
       "      <td>46</td>\n",
       "      <td>21,511,981.0</td>\n",
       "      <td>13,967,487.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2025-01-24</td>\n",
       "      <td>22</td>\n",
       "      <td>3,362,163.0</td>\n",
       "      <td>3,357,630.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2025-01-23</td>\n",
       "      <td>8</td>\n",
       "      <td>1,808,445.0</td>\n",
       "      <td>1,699,898.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2025-01-22</td>\n",
       "      <td>47</td>\n",
       "      <td>18,047,651.0</td>\n",
       "      <td>16,968,552.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2025-01-21</td>\n",
       "      <td>13</td>\n",
       "      <td>5,512,491.0</td>\n",
       "      <td>5,046,747.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2025-01-20</td>\n",
       "      <td>1</td>\n",
       "      <td>28,465.0</td>\n",
       "      <td>22,772.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2025-01-17</td>\n",
       "      <td>6</td>\n",
       "      <td>6,713,997.0</td>\n",
       "      <td>6,601,489.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2025-01-16</td>\n",
       "      <td>10</td>\n",
       "      <td>647,664.0</td>\n",
       "      <td>452,834.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>2025-01-15</td>\n",
       "      <td>16</td>\n",
       "      <td>407,978.0</td>\n",
       "      <td>401,896.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2025-01-14</td>\n",
       "      <td>11</td>\n",
       "      <td>516,138.0</td>\n",
       "      <td>383,999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2025-01-13</td>\n",
       "      <td>20</td>\n",
       "      <td>3,642,972.0</td>\n",
       "      <td>2,804,801.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2025-01-10</td>\n",
       "      <td>20</td>\n",
       "      <td>631,420.0</td>\n",
       "      <td>495,439.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2025-01-09</td>\n",
       "      <td>2</td>\n",
       "      <td>309,576.0</td>\n",
       "      <td>204,666.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2025-01-08</td>\n",
       "      <td>14</td>\n",
       "      <td>4,021,859.0</td>\n",
       "      <td>3,656,132.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2025-01-07</td>\n",
       "      <td>116</td>\n",
       "      <td>35,415,855.0</td>\n",
       "      <td>24,032,601.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   CONCESSIONE  CONCESSIONI     NOMINALE        AIUTI\n",
       "0   2025-01-31           32 12,053,460.0  9,138,731.0\n",
       "1   2025-01-30           31  2,126,257.0  1,895,920.0\n",
       "2   2025-01-29            2     18,000.0     18,000.0\n",
       "3   2025-01-28           46 21,511,981.0 13,967,487.0\n",
       "4   2025-01-24           22  3,362,163.0  3,357,630.0\n",
       "5   2025-01-23            8  1,808,445.0  1,699,898.0\n",
       "6   2025-01-22           47 18,047,651.0 16,968,552.0\n",
       "7   2025-01-21           13  5,512,491.0  5,046,747.0\n",
       "8   2025-01-20            1     28,465.0     22,772.0\n",
       "9   2025-01-17            6  6,713,997.0  6,601,489.0\n",
       "10  2025-01-16           10    647,664.0    452,834.0\n",
       "11  2025-01-15           16    407,978.0    401,896.0\n",
       "12  2025-01-14           11    516,138.0    383,999.0\n",
       "13  2025-01-13           20  3,642,972.0  2,804,801.0\n",
       "14  2025-01-10           20    631,420.0    495,439.0\n",
       "15  2025-01-09            2    309,576.0    204,666.0\n",
       "16  2025-01-08           14  4,021,859.0  3,656,132.0\n",
       "17  2025-01-07          116 35,415,855.0 24,032,601.0"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = con.execute(\"SELECT CONCESSIONE, count(CAR) CONCESSIONI, sum(cast(NOMINALE as integer)) NOMINALE, sum(cast(AIUTO as integer)) AIUTI FROM 'OpenData_Aiuti_2025_01.parquet' where concedente like '%INVI%' group by 1 order by 1 desc\").df()\n",
    "df"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3",
   "path": "C:\\Users\\paolo\\AppData\\Local\\Programs\\Python\\Python311\\share\\jupyter\\kernels\\python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
